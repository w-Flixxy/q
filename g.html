<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Game Center</title>
  <style>
    /* CSS-variabelen voor light mode */
    :root {
      --bg-light: #f0f0f0;
      --text-light: #333;
      --container-light: #fff;
      --nav-light: #3367D6;
      --button-light: #4285F4;
      --button-hover-light: #3367D6;
    }
    /* Globale stijlen */
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-light);
      color: var(--text-light);
      transition: background 0.3s, color 0.3s;
    }
    nav {
      background: var(--nav-light);
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
    }
    nav a {
      color: #fff;
      text-decoration: none;
      padding: 12px 20px;
      margin: 5px;
      border-radius: 5px;
      background: var(--button-light);
      transition: background 0.3s;
    }
    nav a:hover { background: var(--button-hover-light); }
    .container {
      max-width: 1000px;
      margin: 20px auto;
      padding: 20px;
      background: var(--container-light);
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      transition: background 0.3s;
    }
    .game-section { display: none; }
    .game-section.active { display: block; }
    button {
      padding: 10px 15px;
      margin: 10px 5px;
      border: none;
      border-radius: 5px;
      background: var(--button-light);
      color: #fff;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover { background: var(--button-hover-light); }
    input[type="number"] {
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 3px;
      width: 60px;
    }
    @media (max-width: 768px) {
      .container { margin: 10px; padding: 15px; }
      nav { flex-direction: column; }
    }
    /* Dark mode-stijlen */
    body.dark {
      background: #121212;
      color: #e0e0e0;
    }
    body.dark .container {
      background: #1e1e1e;
      box-shadow: 0 0 10px rgba(255,255,255,0.1);
    }
    body.dark nav {
      background: #333;
    }
    body.dark nav a {
      background: #444;
      color: #e0e0e0;
    }
    body.dark nav a:hover {
      background: #555;
    }
    body.dark #plinkoCanvas, 
    body.dark .reel {
      border-color: #444;
      background: #333;
    }
    /* Idle Miner-stijlen */
    #mineArea {
      width: 100%;
      height: 200px;
      background: linear-gradient(135deg, #555, #333);
      border: 2px solid #222;
      border-radius: 10px;
      position: relative;
      margin-bottom: 15px;
      cursor: pointer;
      overflow: hidden;
    }
    #mineArea .minerIcon {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 4em;
      pointer-events: none;
      user-select: none;
    }
    .coin {
      position: absolute;
      font-size: 1.5em;
      pointer-events: none;
      animation: floatUp 1s ease-out forwards;
    }
    @keyframes floatUp {
      0% { opacity: 1; transform: translateY(0); }
      100% { opacity: 0; transform: translateY(-50px); }
    }
    /* Higher/Lower-stijlen */
    #hlCardsContainer {
      position: relative;
      width: 150px; /* breedte van de huidige kaart */
      margin: 0 auto 10px auto;
      height: 200px; /* zelfde hoogte als huidige kaart */
    }
    #hlCurrentCard {
      width: 150px;
      height: 200px;
      background: #fff;
      border: 4px solid var(--button-light);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3em;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      perspective: 1000px;
    }
    #hlCurrentCard.flip {
      animation: flipCard 0.6s forwards;
    }
    @keyframes flipCard {
      0% { transform: translateX(-50%) rotateY(0deg); }
      50% { transform: translateX(-50%) rotateY(90deg); }
      100% { transform: translateX(-50%) rotateY(0deg); }
    }
    #hlPrevCard {
      width: 100px;
      height: 130px;
      background: #fff;
      border: 2px solid var(--button-light);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2em;
      position: absolute;
      left: -110px;  /* links van de huidige kaart */
      top: 35px;     /* verticaal gecentreerd t.o.v. de huidige kaart */
    }
    #hlButtons {
      text-align: center;
      margin-top: 10px;
    }
    #hlButtons button {
      font-size: 1.5em;
      padding: 15px 20px;
    }
    /* Plinko-stijlen */
    #plinkoCanvas {
      border: 2px solid var(--button-light);
      border-radius: 10px;
      background: #fafafa;
      display: block;
      margin: 10px auto;
    }
    /* Slot Machine-stijlen */
    .reel {
      width: 80px;
      height: 80px;
      border: 2px solid var(--button-light);
      border-radius: 10px;
      margin: 0 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fafafa;
    }
    .reel-emoji {
      font-size: 3em;
    }
    .spinning {
      animation: spinAnimation 0.5s linear infinite;
    }
    @keyframes spinAnimation {
      from { transform: rotateX(0deg); }
      to { transform: rotateX(360deg); }
    }
  </style>
</head>
<body>
  <nav>
    <a href="#" data-target="idleMinerSection">Idle Miner</a>
    <a href="#" data-target="higherLowerSection">Higher/Lower</a>
    <a href="#" data-target="plinkoSection">Plinko</a>
    <a href="#" data-target="slotMachineSection">Slot Machine</a>
    <a href="#" id="toggleDarkMode">Toggle Dark Mode</a>
  </nav>
  <div class="container">
    <!-- Idle Miner-sectie -->
    <div id="idleMinerSection" class="game-section active">
      <h2>Idle Miner</h2>
      <div id="mineArea">
        <div class="minerIcon">‚õèÔ∏è</div>
      </div>
      <div style="text-align:center;">
        <span>Coins: <span id="idleCoins">0</span></span>
        <span style="margin-left:20px;">Power: <span id="idleClickPower">1</span></span>
        <span style="margin-left:20px;">Miners: <span id="idleMiners">0</span></span>
      </div>
      <div style="text-align:center; margin-top:10px;">
        <button id="upgradePickaxeButton">Upgrade Pickaxe<br>(Cost: <span id="pickaxeCost">10</span>)</button>
        <button id="hireMinerButton">Hire Miner<br>(Cost: <span id="minerCost">50</span>)</button>
        <button id="resetIdleButton" style="background:#cc0000;">Reset</button>
      </div>
    </div>
    <!-- Higher/Lower-sectie -->
    <div id="higherLowerSection" class="game-section">
      <h2>Higher/Lower</h2>
      <div id="hlCardsContainer">
        <div id="hlPrevCard">N/A</div>
        <div id="hlCurrentCard">0</div>
      </div>
      <div style="text-align:center; margin-top:10px;">
        Score: <span id="hlScore">0</span>
      </div>
      <div id="hlButtons">
        <button id="higherButton">‚ñ≤</button>
        <button id="lowerButton">‚ñº</button>
        <button id="resetHLButton" style="background:#cc0000;">Reset</button>
      </div>
    </div>
    <!-- Plinko-sectie -->
    <div id="plinkoSection" class="game-section">
      <h2>Plinko</h2>
      <div style="text-align:center; margin-bottom:10px;">
        Balance: <span id="globalBalancePlinko">0</span>
      </div>
      <div style="text-align:center; margin-bottom:10px;">
        <label for="plinkoBet">Bet Amount:</label>
        <input type="number" id="plinkoBet" value="10" min="1">
      </div>
      <canvas id="plinkoCanvas" width="400" height="600"></canvas>
      <div style="text-align:center; margin-top:10px;">
        <button id="dropBallButton">Drop Ball</button>
        <button id="resetPlinkoButton" style="background:#cc0000;">Reset</button>
      </div>
    </div>
    <!-- Slot Machine-sectie -->
    <div id="slotMachineSection" class="game-section">
      <h2>Slot Machine</h2>
      <div style="text-align:center; margin-bottom:10px;">
        Balance: <span id="globalBalanceSlot">0</span>
      </div>
      <div style="text-align:center; margin-bottom:10px;">
        <label for="betAmount">Bet Amount:</label>
        <input type="number" id="betAmount" value="10" min="1">
      </div>
      <div id="slotMachine" style="display:flex; justify-content:center; margin-bottom:10px;">
        <div class="reel" id="reel1"><span class="reel-emoji">üçí</span></div>
        <div class="reel" id="reel2"><span class="reel-emoji">üçí</span></div>
        <div class="reel" id="reel3"><span class="reel-emoji">üçí</span></div>
      </div>
      <div style="text-align:center;">
        <button id="spinSlotButton">Spin</button>
      </div>
      <div id="slotResult" style="text-align:center; margin-top:10px;"></div>
    </div>
  </div>
  <script>
    /*******************************
     * Globale balans-updates
     *******************************/
    function updateGlobalBalanceDisplays() {
      document.getElementById('globalBalancePlinko').innerText = idleData.coins.toFixed(1);
      document.getElementById('globalBalanceSlot').innerText = idleData.coins.toFixed(1);
    }
    /*******************************
     * Navigatie & Dark Mode
     *******************************/
    document.querySelectorAll('nav a[data-target]').forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        const target = this.getAttribute('data-target');
        document.querySelectorAll('.game-section').forEach(section => section.classList.remove('active'));
        document.getElementById(target).classList.add('active');
      });
    });
    document.getElementById('toggleDarkMode').addEventListener('click', function(e) {
      e.preventDefault();
      document.body.classList.toggle('dark');
      localStorage.setItem('darkMode', document.body.classList.contains('dark'));
    });
    if(localStorage.getItem('darkMode') === 'true'){
      document.body.classList.add('dark');
    }
    /*******************************
     * Globale valuta (Idle Miner Data)
     *******************************/
    let idleData = {
      coins: 0,
      clickPower: 1,
      miners: 0,
      pickaxeCost: 10,
      minerCost: 50
    };
    function loadIdleData() {
      const saved = localStorage.getItem('idleData');
      if(saved) idleData = JSON.parse(saved);
      updateIdleDisplay();
    }
    function saveIdleData() {
      localStorage.setItem('idleData', JSON.stringify(idleData));
    }
    function updateIdleDisplay() {
      document.getElementById('idleCoins').innerText = idleData.coins.toFixed(1);
      document.getElementById('idleClickPower').innerText = idleData.clickPower;
      document.getElementById('idleMiners').innerText = idleData.miners;
      document.getElementById('pickaxeCost').innerText = Math.floor(idleData.pickaxeCost);
      document.getElementById('minerCost').innerText = Math.floor(idleData.minerCost);
      updateGlobalBalanceDisplays();
    }
    // Idle Miner: klik op het mijngebied om coins te verdienen
    document.getElementById('mineArea').addEventListener('click', function(e) {
      idleData.coins += idleData.clickPower;
      updateIdleDisplay();
      saveIdleData();
      const coin = document.createElement('div');
      coin.className = 'coin';
      coin.innerText = 'üí∞';
      const rect = this.getBoundingClientRect();
      coin.style.left = (e.clientX - rect.left) + 'px';
      coin.style.top = (e.clientY - rect.top) + 'px';
      this.appendChild(coin);
      coin.addEventListener('animationend', () => coin.remove());
    });
    document.getElementById('upgradePickaxeButton').addEventListener('click', function() {
      if(idleData.coins >= idleData.pickaxeCost) {
        idleData.coins -= idleData.pickaxeCost;
        idleData.clickPower += 1;
        idleData.pickaxeCost *= 1.5;
        updateIdleDisplay();
        saveIdleData();
      } else {
        alert("Not enough coins!");
      }
    });
    document.getElementById('hireMinerButton').addEventListener('click', function() {
      if(idleData.coins >= idleData.minerCost) {
        idleData.coins -= idleData.minerCost;
        idleData.miners += 1;
        idleData.minerCost *= 1.7;
        updateIdleDisplay();
        saveIdleData();
      } else {
        alert("Not enough coins!");
      }
    });
    document.getElementById('resetIdleButton').addEventListener('click', function() {
      if(confirm("Reset Idle Miner?")) {
        idleData = { coins: 0, clickPower: 1, miners: 0, pickaxeCost: 10, minerCost: 50 };
        updateIdleDisplay();
        saveIdleData();
      }
    });
    setInterval(() => {
      if(idleData.miners > 0) {
        idleData.coins += idleData.miners;
        updateIdleDisplay();
        saveIdleData();
      }
    }, 1000);
    loadIdleData();
    /*******************************
     * Higher/Lower Game
     *******************************/
    let hlData = {
      currentNumber: 0,
      score: 0,
      prevNumber: null
    };
    function startHLGame() {
      hlData.currentNumber = Math.floor(Math.random() * 100) + 1;
      hlData.score = 0;
      hlData.prevNumber = null;
      updateHLDisplay();
    }
    function updateHLDisplay() {
      document.getElementById('hlCurrentCard').innerText = hlData.currentNumber;
      document.getElementById('hlPrevCard').innerText = hlData.prevNumber !== null ? hlData.prevNumber : "N/A";
      document.getElementById('hlScore').innerText = hlData.score;
    }
    function flipHLCard(newNumber) {
      const card = document.getElementById('hlCurrentCard');
      card.classList.add('flip');
      setTimeout(() => {
        card.innerText = newNumber;
        card.classList.remove('flip');
      }, 600);
    }
    document.getElementById('higherButton').addEventListener('click', function() {
      let next = Math.floor(Math.random() * 100) + 1;
      if (next > hlData.currentNumber) {
        hlData.score++;
        hlData.prevNumber = hlData.currentNumber;
        flipHLCard(next);
        hlData.currentNumber = next;
      } else {
        alert("Wrong! Game Over. Score: " + hlData.score);
        startHLGame();
        return;
      }
      updateHLDisplay();
    });
    document.getElementById('lowerButton').addEventListener('click', function() {
      let next = Math.floor(Math.random() * 100) + 1;
      if (next < hlData.currentNumber) {
        hlData.score++;
        hlData.prevNumber = hlData.currentNumber;
        flipHLCard(next);
        hlData.currentNumber = next;
      } else {
        alert("Wrong! Game Over. Score: " + hlData.score);
        startHLGame();
        return;
      }
      updateHLDisplay();
    });
    document.getElementById('resetHLButton').addEventListener('click', function() {
      if(confirm("Reset Higher/Lower?")) {
        startHLGame();
      }
    });
    startHLGame();
    /*******************************
     * Plinko Game
     *******************************/
    const plinkoCanvas = document.getElementById('plinkoCanvas');
    const plinkoCtx = plinkoCanvas.getContext('2d');
    const plinkoWidth = plinkoCanvas.width;
    const plinkoHeight = plinkoCanvas.height;
    // 9 bins met vaste multipliers: 10x, 2x, 1x, 0.5x, 0.2x, 0.5x, 1x, 2x, 10x
    const binCount = 9;
    const binMultipliers = [10, 2, 1, 0.5, 0.2, 0.5, 1, 2, 10];
    const binWidth = plinkoWidth / binCount;
    // Genereer stokken (pegs)
    const plinkoPegs = [];
    const pegRows = 8;
    const pegSpacingX = plinkoWidth / 10;
    const pegSpacingY = 60;
    const pegRadius = 5;
    for (let row = 0; row < pegRows; row++) {
      let offset = (row % 2 === 0) ? pegSpacingX / 2 : 0;
      let numPegs = Math.floor(plinkoWidth / pegSpacingX);
      for (let i = 0; i < numPegs; i++) {
        plinkoPegs.push({
          x: offset + i * pegSpacingX,
          y: 50 + row * pegSpacingY,
          r: pegRadius
        });
      }
    }
    let plinkoBalls = [];
    function updatePlinko() {
      plinkoCtx.clearRect(0, 0, plinkoWidth, plinkoHeight);
      // Teken bins
      for (let i = 0; i < binCount; i++) {
        plinkoCtx.fillStyle = "#ddd";
        plinkoCtx.fillRect(i * binWidth, plinkoHeight - 30, binWidth, 30);
        plinkoCtx.fillStyle = "#333";
        plinkoCtx.font = "14px sans-serif";
        plinkoCtx.textAlign = "center";
        plinkoCtx.fillText(binMultipliers[i] + "x", i * binWidth + binWidth / 2, plinkoHeight - 10);
      }
      // Teken stokken
      plinkoCtx.fillStyle = "#007acc";
      plinkoPegs.forEach(peg => {
        plinkoCtx.beginPath();
        plinkoCtx.arc(peg.x, peg.y, peg.r, 0, Math.PI * 2);
        plinkoCtx.fill();
      });
      // Update en teken ballen
      for (let b = plinkoBalls.length - 1; b >= 0; b--) {
        const ball = plinkoBalls[b];
        ball.vy += 0.6;  // zwaartekracht
        // Voeg heel subtiele horizontale ruis toe (optioneel, erg laag)
        ball.vx += (Math.random() - 0.5) * 0.02;
        ball.x += ball.vx;
        ball.y += ball.vy;
        // Rem horizontale snelheid bij randen
        if (ball.x < ball.r + 20) {
          ball.vx = Math.abs(ball.vx) * 0.5;
        }
        if (ball.x > plinkoWidth - ball.r - 20) {
          ball.vx = -Math.abs(ball.vx) * 0.5;
        }
        // Botsing met wanden
        if (ball.x < ball.r || ball.x > plinkoWidth - ball.r) {
          ball.vx *= -1;
        }
        // Botsingen met stokken (pegs) ‚Äì minder elastisch en alleen lichte zijwaartse duw
        plinkoPegs.forEach(peg => {
          let dx = ball.x - peg.x;
          let dy = ball.y - peg.y;
          let dist = Math.sqrt(dx * dx + dy * dy);
          let minDist = ball.r + peg.r;
          if (dist < minDist && dist > 0) {
            let nx = dx / dist;
            let ny = dy / dist;
            let overlap = minDist - dist;
            // Verplaats de bal net buiten de peg
            ball.x += nx * overlap;
            ball.y += ny * overlap;
            // Geef een kleine zijwaartse impuls, maar behoud de neerwaartse snelheid grotendeels
            ball.vx += nx * 0.03;
            // Optioneel: lichte demping op de verticale snelheid (niet te sterk)
            ball.vy *= 0.98;
          }
        });
        // (Optioneel) Bal-tot-bal botsingen kunnen eruit worden gelaten voor eenvoud; hier laten we ze lichtjes gebeuren
        for (let i = 0; i < plinkoBalls.length; i++) {
          for (let j = i + 1; j < plinkoBalls.length; j++) {
            let ballA = plinkoBalls[i];
            let ballB = plinkoBalls[j];
            let dx = ballB.x - ballA.x;
            let dy = ballB.y - ballA.y;
            let dist = Math.sqrt(dx * dx + dy * dy);
            let minDist = ballA.r + ballB.r;
            if (dist < minDist && dist > 0) {
              let overlap = (minDist - dist) / 2;
              let angle = Math.atan2(dy, dx);
              let nx = Math.cos(angle);
              let ny = Math.sin(angle);
              ballA.x -= nx * overlap;
              ballA.y -= ny * overlap;
              ballB.x += nx * overlap;
              ballB.y += ny * overlap;
            }
          }
        }
        // Teken de bal
        plinkoCtx.fillStyle = "#e67e22";
        plinkoCtx.beginPath();
        plinkoCtx.arc(ball.x, ball.y, ball.r, 0, Math.PI * 2);
        plinkoCtx.fill();
        // Als de bal de bodem heeft bereikt, pas de winst toe en verwijder de bal
        if (ball.y + ball.r > plinkoHeight - 30) {
          let binIndex = Math.floor(ball.x / binWidth);
          if (binIndex < 0) binIndex = 0;
          if (binIndex >= binCount) binIndex = binCount - 1;
          let multiplier = binMultipliers[binIndex];
          let winnings = ball.bet * multiplier;
          idleData.coins += winnings;
          updateIdleDisplay();
          saveIdleData();
          plinkoBalls.splice(b, 1);
        }
      }
      requestAnimationFrame(updatePlinko);
    }
    document.getElementById('dropBallButton').addEventListener('click', function() {
      let bet = parseFloat(document.getElementById('plinkoBet').value);
      if (isNaN(bet) || bet <= 0) {
        alert("Enter a valid bet.");
        return;
      }
      if (idleData.coins < bet) {
        alert("Not enough coins!");
        return;
      }
      idleData.coins -= bet;
      updateIdleDisplay();
      saveIdleData();
      let ball = {
        x: plinkoWidth / 2 + (Math.random() - 0.5) * 10,
        y: 20,
        r: 8,
        vx: (Math.random() - 0.5) * 2,
        vy: 0,
        bet: bet
      };
      plinkoBalls.push(ball);
    });
    document.getElementById('resetPlinkoButton').addEventListener('click', function() {
      if (confirm("Reset Plinko?")) {
        alert("Plinko has been reset.");
      }
    });
    updatePlinko();
    /*******************************
     * Slot Machine Game
     *******************************/
    const slotSymbols = ["üçí", "üçã", "üîî", "‚≠ê", "7Ô∏è‚É£", "üçÄ"];
    function spinReel(reelElement, duration) {
      return new Promise(resolve => {
        const emojiElement = reelElement.querySelector('.reel-emoji');
        emojiElement.classList.add("spinning");
        let interval = setInterval(() => {
          emojiElement.innerText = slotSymbols[Math.floor(Math.random() * slotSymbols.length)];
        }, 100);
        setTimeout(() => {
          clearInterval(interval);
          emojiElement.classList.remove("spinning");
          let finalSymbol = slotSymbols[Math.floor(Math.random() * slotSymbols.length)];
          emojiElement.innerText = finalSymbol;
          resolve(finalSymbol);
        }, duration);
      });
    }
    document.getElementById('spinSlotButton').addEventListener('click', async function() {
      let bet = parseFloat(document.getElementById('betAmount').value);
      if (isNaN(bet) || bet <= 0) {
        alert("Enter a valid bet.");
        return;
      }
      if (idleData.coins < bet) {
        alert("Not enough coins!");
        return;
      }
      idleData.coins -= bet;
      updateIdleDisplay();
      saveIdleData();
      document.getElementById('slotResult').innerText = "";
      const reel1 = document.getElementById('reel1');
      const reel2 = document.getElementById('reel2');
      const reel3 = document.getElementById('reel3');
      const symbol1 = await spinReel(reel1, 1200);
      const symbol2 = await spinReel(reel2, 1600);
      const symbol3 = await spinReel(reel3, 2000);
      let winnings = 0;
      if (symbol1 === symbol2 && symbol2 === symbol3) {
        winnings = bet * 5;
        document.getElementById('slotResult').innerText = "Jackpot! You win " + winnings + " coins!";
      } else if (symbol1 === symbol2 || symbol1 === symbol3 || symbol2 === symbol3) {
        winnings = bet * 2;
        document.getElementById('slotResult').innerText = "You win " + winnings + " coins!";
      } else {
        document.getElementById('slotResult').innerText = "Sorry, you lose.";
      }
      idleData.coins += winnings;
      updateIdleDisplay();
      saveIdleData();
    });
  </script>
</body>
</html>
